<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=0">

		<title>个人资料</title>

		<link href="../AmazeUI-2.4.2/assets/css/admin.css" rel="stylesheet" type="text/css">
		<link href="../AmazeUI-2.4.2/assets/css/amazeui.css" rel="stylesheet" type="text/css">

		<link href="../css/personal.css" rel="stylesheet" type="text/css">
		<link href="../css/infstyle.css" rel="stylesheet" type="text/css">
		<script src="../AmazeUI-2.4.2/assets/js/jquery.min.js" type="text/javascript"></script>
		<script src="../AmazeUI-2.4.2/assets/js/amazeui.js" type="text/javascript"></script>
			
	</head>
	<body>
		<!--头 -->
		<header>
			<article>
				<div class="mt-logo">
					<!--顶部导航条 -->
					<div class="am-container header">
						<ul class="message-l">
							<div class="topMessage">
								<div class="menu-hd">
									<a href="../home/login.html" target="_top" class="h">亲，请登录</a>
									<a href="../home/register.html" target="_top">免费注册</a>
								</div>
							</div>
						</ul>
						<ul class="message-r">
							<div class="topMessage home">
								<div class="menu-hd"><a href="../home/home.html" target="_top" class="h">商城首页</a></div>
							</div>
							<div class="topMessage my-shangcheng">
								<div class="menu-hd MyShangcheng"><a href="#" target="_top"><i class="am-icon-user am-icon-fw"></i>个人中心</a></div>
							</div>
							<div class="topMessage mini-cart">
								<div class="menu-hd"><a id="mc-menu-hd" href="../home/shopcart.html" target="_top"><i class="am-icon-shopping-cart  am-icon-fw"></i><span>购物车</span><strong id="J_MiniCartNum" class="h">0</strong></a></div>
							</div>
							<div class="topMessage favorite">
								<div class="menu-hd"><a href="collection.html" target="_top"><i class="am-icon-heart am-icon-fw"></i><span>收藏夹</span></a></div>
						</ul>
						</div>

						<!--悬浮搜索框-->

						<div class="nav white">
							<div class="logoBig">
								<li><img src="../images/logobig.png" /></li>
							</div>

							<div class="search-bar pr">
								<a name="index_none_header_sysc" href="#"></a>
								<form>
									<input id="searchInput" name="index_none_header_sysc" type="text" placeholder="搜索" autocomplete="off">
									<input id="ai-topsearch" class="submit am-btn" value="搜索" index="1" type="submit">
								</form>
							</div>
						</div>

						<div class="clear"></div>
					</div>
				</div>
			</article>
		</header>
            <div class="nav-table">
					   <div class="long-title"><span class="all-goods">全部分类</span></div>
					   <div class="nav-cont">
							<ul>
								<li class="index"><a href="#">首页</a></li>
                                <li class="qc"><a href="#">闪购</a></li>
                                <li class="qc"><a href="#">限时抢</a></li>
                                <li class="qc"><a href="#">团购</a></li>
                                <li class="qc last"><a href="#">大包装</a></li>
							</ul>
						    <div class="nav-extra">
						    	<i class="am-icon-user-secret am-icon-md nav-user"></i><b></b>我的福利
						    	<i class="am-icon-angle-right" style="padding-left: 10px;"></i>
						    </div>
						</div>
			</div>
			<b class="line"></b>
		<div class="center">
			<div class="col-main">
				<div class="main-wrap">

					<div class="user-info">
						<!--标题 -->
						<div class="am-cf am-padding">
							<div class="am-fl am-cf"><strong class="am-text-danger am-text-lg">个人资料</strong> / <small>Personal&nbsp;information</small></div>
						</div>
						<hr/>

						<!--头像 -->
						
							<div class="user-infoPic">

								<div class="filePic">
									<form method="post" enctype="multipart/form-data" name="myform">
										<input type="file" class="inputPic" allowexts="gif,jpeg,jpg,png,bmp" accept="image/*" name="heading">
									</form>
									<img class="am-circle am-img-thumbnail" src="../images/getAvatar.do.jpg" alt=""id="headimg" />
								</div>

								<p class="am-form-help">头像</p>

								<div class="info-m">
									<div  style="color:red;"><b>用户名：
											<i id="username">小叮当
									</i></b></div>
									<div class="u-level">
										<span class="rank r2">
								             <s class="vip1"></s><a class="classes" href="#">铜牌会员</a>
							            </span>
									</div>
									<div class="u-safety">
										<a href="safety.html">
										 账户安全
										<span class="u-profile"><i class="bc_ee0000" style="width: 60px;" width="0">60分</i></span>
										</a>
									</div>
								</div>
							</div>

						<!--个人信息 -->
						<div class="info-main">
							<form class="am-form am-form-horizontal" method="post" action="../php/addData.php" enctype="multipart/form-data" id="form1" name = "myform">
								<div class="am-form-group">
									<label for="user-name2" class="am-form-label">昵称</label>
									<div class="am-form-content">
										<input type="text" disabled = "disabled" id="username1"
											placeholder = "nichen" name="username">

									</div>
								</div>

								<div class="am-form-group">
									<label for="user-name" class="am-form-label">姓名</label>
									<div class="am-form-content">
										<input type="text" id="realname" placeholder="name" name="realname">

									</div>
								</div>

								<div class="am-form-group">
									<label class="am-form-label">性别</label>
									<div class="am-form-content sex">
										<label class="am-radio-inline">
											<input type="radio" name="radio10" value="male" data-am-ucheck class="sex"> 男
										</label>
										<label class="am-radio-inline">
											<input type="radio" name="radio10" value="female" data-am-ucheck  class="sex"> 女
										</label>
										<label class="am-radio-inline">
											<input type="radio" name="radio10" value="secret" data-am-ucheck  class="sex"> 保密
										</label>
									</div>
								</div>

								<div class="am-form-group">
									<label for="user-birth" class="am-form-label">年龄</label>
									<input type="text" id="age" placeholder="age" name="age" style="width: 640px;margin-left:85px;">
							
								</div>
								<div class="am-form-group">
									<label for="user-phone" class="am-form-label">电话</label>
									<div class="am-form-content">
										<input id="telephone" placeholder="telephonenumber" type="tel" name="telephone">

									</div>
								</div>
								<div class="am-form-group">
									<label for="user-email" class="am-form-label">电子邮件</label>
									<div class="am-form-content">
										<input id="email" name="email" placeholder="Email" type="email">

									</div>
								</div>
								<div class="am-form-group">
									<label for="user-email" class="am-form-label">余额</label>
									<div class="am-form-content">
										<input id="money" name="email" placeholder="money" type="email" style="width: 150px;">
									</div>
									<div class="am-btn am-btn-danger" style="float:left;margin:-31px 274px;background-color:#eee;color:#333;border-color:#eee;">充值</div>
								</div>		
								<div class="info-btn">
									<div class="am-btn am-btn-danger"id="submit">修改个人信息</div>
									<div class="am-btn am-btn-danger"id="button" style="display:none;">提交</div>
								</div>
							</form>
						</div>

					</div>

				</div>
				<!--底部-->
				<div class="footer">
					<div class="footer-hd">
						<p>
							<a href="#">恒望科技</a>
							<b>|</b>
							<a href="#">商城首页</a>
							<b>|</b>
							<a href="#">支付宝</a>
							<b>|</b>
							<a href="#">物流</a>
						</p>
					</div>
					<div class="footer-bd">
						<p>
							<a href="#">关于恒望</a>
							<a href="#">合作伙伴</a>
							<a href="#">联系我们</a>
							<a href="#">网站地图</a>
							<em>© 2015-2025 Hengwang.com 版权所有. 更多模板 <a href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a> - Collect from <a href="http://www.cssmoban.com/" title="网页模板" target="_blank">网页模板</a></em>
						</p>
					</div>
				</div>
			</div>

			<aside class="menu">
				<ul>
					<li class="person">
						<a href="index.html">个人中心</a>
					</li>
					<li class="person">
						<a href="person.php">个人资料</a>
						<ul>
							<li class="active"> <a href="information.html">个人信息</a></li>
							<li> <a href="safety.html">安全设置</a></li>
							<li> <a href="address.html">收货地址</a></li>
						</ul>
					</li>
					<li class="person">
						<a href="#">我的交易</a>
						<ul>
							<li><a href="order.html">订单管理</a></li>
							<li> <a href="change.html">退款售后</a></li>
						</ul>
					</li>
					<li class="person">
						<a href="#">我的资产</a>
						<ul>
							<li> <a href="coupon.html">优惠券 </a></li>
							<li> <a href="bonus.html">红包</a></li>
							<li> <a href="bill.html">账单明细</a></li>
						</ul>
					</li>

					<li class="person">
						<a href="#">我的小窝</a>
						<ul>
							<li> <a href="collection.html">收藏</a></li>
							<li> <a href="foot.html">足迹</a></li>
							<li> <a href="comment.html">评价</a></li>
							<li> <a href="news.html">消息</a></li>
						</ul>
					</li>

				</ul>

			</aside>
		</div>
	</body>
	<script src="../basic/js/jquery-1.7.min.js"></script>
	<script src="../basic/js/jquery-1.9.min.js"></script>
	<script>
		//显示用户信息
		var username = document.getElementById('username');
		var username1 = document.getElementById('username1');
		var telephone = document.getElementById('telephone');
		var email = document.getElementById('email');
		var money = document.getElementById('money');
		var age = document.getElementById('age');
		var realname = document.getElementById('realname');
		$.post(
			"../php/showInfo.php",
			"",
			function(data){
				for(var i in data){
					username.innerHTML = data['username'];
					username1.value = data['username'];
					money.value = data['money'];
					telephone.value = data['telephone'];
					email.value = data['email'];
					age.value = data['age'];
					realname.value = data['realname'];

					$(".user-info input").attr("disabled","disabled");
					if(data['status'] == 1){
						data['status'] = "正常";
					}
					if(data['sex'] == 0){
						data['sex'] = "保密";
						$("input[name='radio10']").eq(2).attr("checked","checked");
					}else if(data['sex'] == 1){
						data['sex'] = "女";
						$("input[name='radio10']").eq(1).attr("checked","checked");
					}else if(data['sex'] == 2){
						data['sex'] = "男";
						$("input[name='radio10']").eq(0).attr("checked","checked");
					}
					if(i == "heading"){
						if(data['heading'] == null){
							$("#headimg").attr("src","../images/getAvatar.do.jpg");
						}else{
							$("#headimg").attr("src",data['heading']);
						}
					}
				}
			},
			"json"
		);
	
		//修改个人信息
		$("#submit").click(function() {
			$(".user-info input").removeAttr("disabled","disabled");
			$("#username1").attr("disabled","disabled");
			$("#money").attr("disabled","disabled");
			$("#button").css("display","black");
			$(this).css("display","none");
			$("#button").click(function() {
				$.post(
					"../php/updateInfo.php",
					"",
					function(msg){
						console.log(msg);
						if(msg == 1) {
							alert("修改成功！");
						}else if(msg == 0) {
							alert("修改失败!");
						}
							
					}
				)});
		});

		// 头像被点击
		$("#headimg").click(function(){
			// 模拟input type=file 被点击
			$(".headimg").click();
			// ajax上传
			// 1.监听input type=file
			// 2.H5 FileReader
			// 3.formdata
		});

		// 图片上传框被改变
		$(".inputPic").change(function(){
			var file = this.files[0];//获取文件
            var reader = new FileReader(); //生成FileReader对象
            reader.readAsDataURL(file); //执行读取文件路径命令
            reader.onload = function(){ //读取完成事件
                $("#headimg").attr("src",reader.result);//将读取到的路径用于显示
                var button = $("<button>上传</button>").click(function(){
                	self = $(this);
                	// ajax上传
                	var formdata = new FormData(myform);
					$.ajax({
						type:"post",
						url:"../php/imgFile.php",
						data:formdata,
						processData:false,//不转换字符串
						contentType:false,//不对表单数据编码
						success:function(msg){
							if(msg == "success"){
								self.css("display","none");
								alert("上传成功");
							}
						}
					});
                });
                $("#headimg").after(button);
            }
		});
	</script>

</html>